{% extends 'relecov_core/base.html' %}
{% load static %}
{%load plotly_dash%}

{% block content %}

{% include "relecov_dashboard/sideMenuFuncionality.html" %}

<section>
    <div class="container">
        <!-- Page Wrapper -->
        <div id="wrapper">

            <!-- Sidebar -->
            {% include "relecov_dashboard/variantSideBar.html" %}
            <!-- End of Sidebar -->

            <!-- Content Wrapper -->
            <div id="content-wrapper" class="d-flex flex-column">

                <!-- Main Content -->
                <div id="content">
                    <!-- Begin Page Content -->
                    <div class="container-fluid">

                        <!-- Page Heading -->
                        <div class="row"  style="text-align: center">
                            <h2>Variant mutations in Lineages dashboard</h2>
                        </div> <!-- end row -->
                        <hr>
                        <!-- Content Row -->
                        <div class="row" style="text-align: center;">
                            {% if ERROR %}
                                <div class="container-fluid text-center">
                                    <!--header-->
                                    <div class="card bg-light d-inline-flex p-3" style="width: 80%;">
                                    <div class="container-fluid" style="text-align: center;">
                                            <div class="card d-inline-flex flex-column w-auto p-5 border border-danger" style="width: 18rem;">
                                                <div class="card-body">
                                                    <h2 class="card-title text-danger">Unable to display dashboard</h2>
                                                    <br>
                                                    <p class="card-text text-danger">{{ERROR}}</p>
                                                </div>
                                                <br><br><br>
                                            </div>
                                            </div>
                                        </div>
                                        </div>

                            {% else %}
                                <div class="col-sm-7">
                                    <h4>Search by lineage</h4>
                                    <h5>Choose a lineage and the needle plot will display the positions in all the samples that contain the selected lineage.<br>Click on the Tutorial button to know more about each of the parts that are part of this graph</h5>

                                    <div class="btn-group">
                                        <button type="button" class="btn btn-info">Tutorial</button>
                                        <button type="button" class="btn btn-info dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
                                        <span class="visually-hidden">Toggle Dropdown</span>
                                        </button>
                                        <div class="dropdown-menu">
                                            <div class="dropdown-item">
                                                <div class="card dropdown-item" style="width: auto;">
                                                    <img src="{% static 'relecov_dashboard/custom/img/variants_dashboard_images/mutations_in_lineages_dashboard_images/variants_in_lineages_by_lineage_tutorial.png' %}"class="card-img-left" alt="mutations in lineages by sample"style="width:85%;">
                                                    <div class="card-body">
                                                    <h5 class="card-title">Info about graph elements</h5>
                                                    <ol>
                                                        <li class="card-text"><b>Range slider(Show or Hide) - </b>This element allows us to select if we want to make the rangeslider visible or not</li>
                                                        <li class="card-text"><b>Select a lineage - </b>This element allows us to select a lineage that we want to display.</li>
                                                        <li class="card-text"><b>Mutations - </b>We can filter the graph by mutation value.</li>
                                                        <li class="card-text"><b>Gene Domains - </b>This element allows us to mark the domains of the gene that we need to highlight.</li>
                                                        <li class="card-text"><b>Needle Plot - </b>
                                                            This graph displays variant mutations in Lineages of each sample, using the following data:<br>
                                                            <ul>
                                                                <li>x-axis - Genome position</li>
                                                                <li>y-axis - Allele Frequency (AF)</li>
                                                            </ul>
                                                        </li>
                                                        <li class="card-text"><b>Range slider - </b>This element allows us to select a specific area of ​​the needle plot, in a more comfortable way</li>
                                                    </ol>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body border" style="text-align: center;">
                                    {% plotly_app name="needlePlotMutationByLineage" ratio=1.3 %}
                                </div>
                                </div>
                            </div>
                            <!--end card 1-->

                            <!--card 3-->
                            {% comment %}
                            <div class="card d-inline-flex  p-2 m-1" style="width: 41%">
                                <div class="card-body border" style="text-align: left;">
                                <div class="card-header" ><h2>Heatmap</h2>
                                    <div class="card-subtitle">This needle plot allows you to display variant mutations in Lineages of each sample we select. Click on the Tutorial button to know more about each of the parts that are part of this graph</div>

                                    <div class="btn-group">
                                        <button type="button" class="btn btn-info">Tutorial</button>
                                        <button type="button" class="btn btn-info dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
                                        <span class="visually-hidden">Toggle Dropdown</span>
                                        </button>
                                        <div class="dropdown-menu">
                                            <div class="dropdown-item">
                                                <div class="card dropdown-item" style="width: auto;">
                                                    <img src="{% static 'relecov_dashboard/img/variants_dashboard_images/mutations_in_lineages_dashboard_images/variant_in_lineages_mutation_heatmap_tutorial.png' %}"class="card-img-left" alt="mutations in lineages by sample"style="width:85%;">
                                                    <div class="card-body">
                                                    <h5 class="card-title">Info about graph elements</h5>
                                                    <ol>
                                                        <li class="card-text"><b>Select samples - </b>This element allows us to select the sample or samples we want to display to compare.</li>
                                                        <li class="card-text"><b>Select genes - </b>This element allows us to choose the genes affected in each of the samples to be able to visualize them.</li>
                                                        <li class="card-text"><b>AF - </b>This element shows us the Allele Frequency values ​​related to a certain color.</li>
                                                        <li class="card-text"><b>Samples - </b>In this element all the samples that we choose will be arranged.</li>
                                                        <li class="card-text"><b>Mutations - </b>This element shows us a combination of the name of the gene - name of the mutation.</li>
                                                    </ol>
                                                    <ul>
                                                        <li class="card-text"><b>Heatmap graph - </b>
                                                        This graph displays variant mutations in Lineages of each sample, using the following data:<br>
                                                        <ul>
                                                            <li>x-axis - Mutations</li>
                                                            <li>y-axis - Samples selected</li>
                                                            <li>Color - Express the value of AF relating it to a certain color</li>
                                                        </ul>
                                                    </li>
                                                    </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <a href="/dashboard/variants/mutationsInLineagesHeatmap" class="btn btn-outline-success" role="button" style="margin-left:10%;">Expand</a>
                                </div>
                                <div class="card-body border" style="text-align: center">
                                    {% plotly_app name="mutationHeatmap" ratio=1.1 %}
                                </div>
                                </div>
                            </div>
                            <div class="card d-inline-flex  p-2 m-1" style="width: 41%">
                                <div class="card-body border" style="text-align: left;">
                                <div class="card-header" ><h2>Table filtered by mutation effect</h2>
                                    <div class="card-subtitle">The following table shows us the data related to the mutations present in each sample. We can filter the results by adding or removing mutation effects from the select widget</div>

                                    <div class="btn-group">
                                        <button type="button" class="btn btn-info">Tutorial</button>
                                        <button type="button" class="btn btn-info dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
                                        <span class="visually-hidden">Toggle Dropdown</span>
                                        </button>
                                        <div class="dropdown-menu">
                                            <div class="dropdown-item">
                                                <div class="card dropdown-item" style="width: auto;">
                                                    <div class="card-body">
                                                    <h5 class="card-title">Info about graph elements</h5>
                                                    <ul>
                                                        <span class="fs-5"><b><u>Elements available</u></b></span>
                                                        <li class="card-text"><b>Select effects - </b>This element allows you to filter the results by choosing one or more effects available in the database.</li>
                                                    </ul>
                                                    <hr>
                                                    <ul>
                                                        <span class="fs-5"><b><u>Fields available in the table</u></b></span>
                                                        <li class="card-text"><b>SAMPLE - </b>Number of sample.</li>
                                                        <li class="card-text"><b>POS - </b>Position in the genome.</li>
                                                        <li class="card-text"><b>MUTATION - </b>Mutation name.</li>
                                                        <li class="card-text"><b>AF - </b>Allele Frequency.</li>
                                                        <li class="card-text"><b>EFFECT - </b>Effect name.</li>
                                                        <li class="card-text"><b>GENE - </b>Gene affected by the mutation.</li>
                                                        <li class="card-text"><b>LINEAGE - </b>Lineage assigned to the sample.</li>
                                                    </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <a href="/dashboard/variants/mutationsInLineagesTable" class="btn btn-outline-success" role="button" style="margin-left:10%;">Expand</a>
                                </div>
                                <div class="card-body border" style="text-align: center;">
                                    {% plotly_app name="mutationTable" ratio=1.1 %}
                                </div>
                            {% endcomment %}
                        {% endif %}
                    </div> <!-- End container -->
                </div><!-- End Main Content -->
            </div> <!-- End Content wrapper-->
        </div> <!-- wrapper -->
    </div>  <!-- End container -->
</section>
{% endblock %}
